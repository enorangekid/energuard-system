<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>에너가드컴퍼니 통합 관리 시스템</title> 
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script> 
<link href="https://cdn.quilljs.com/1.3.6/quill.snow.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
<link href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard/dist/web/static/pretendard.css" rel="stylesheet">
<script src="https://cdn.quilljs.com/1.3.6/quill.js"></script>

<link rel="stylesheet" href="css/style.css">
</head>
<body>

  <div id="loginScreen" class="login-wrapper">
    <div class="login-box">
        <h2>에너가드컴퍼니 통합 관리 시스템</h2>
        <input type="password" id="loginPassInput" class="login-input" placeholder="비밀번호를 입력하세요">
        <button class="login-btn" onclick="tryLogin()">로그인</button>
        <div class="login-options">
            <label><input type="checkbox" id="keepLoginCheck"> 로그인 유지하기</label>
        </div>
        <div id="loginMsg" style="color:#e74c3c; margin-top:15px; font-size:13px; font-weight:bold; min-height:18px;"></div>
    </div>
    <div class="footer-login">
        <span class="company-name">주식회사 에너가드컴퍼니</span>
        ADDRESS : 경기도 포천시 가산면 오성길 146<br>
        TEL : 031-511-0377 &nbsp;|&nbsp; FAX : 031-624-1646 &nbsp;|&nbsp; E-MAIL : mdf24t@naver.com<br>
        Copyright ⓒ 주식회사 에너가드컴퍼니. All Rights Reserved.
    </div>
  </div>

  <div id="loader" class="loader">
    <div class="spinner"></div>
    <span>데이터 동기화 중...</span>
  </div>

  <nav class="sidebar" id="sidebar">
    <div class="logo-area" onclick="showPage('dashboard', document.querySelector('.menu-item[onclick*=\'dashboard\']'))" title="지표 요약(홈)으로 이동">
        <div class="brand-text">주식회사 에너가드컴퍼니</div>
        <div class="user-role-badge">관리자</div>
    </div>
    
    <div class="sidebar-scroll-area">
        <ul class="menu-list">
          <li class="menu-item active" onclick="showPage('dashboard', this)" title="지표 요약">
              <div class="icon-circle"><i class="fa-solid fa-chart-pie"></i></div>
              <span class="menu-text">지표 요약</span>
          </li>
          <li class="menu-item" onclick="showPage('timeline', this)" title="업무 타임라인">
              <div class="icon-circle"><i class="fa-solid fa-clock"></i></div>
              <span class="menu-text">업무 타임라인</span>
          </li>
          <li class="menu-item" onclick="showPage('worklog', this)" title="월간 업무일지">
              <div class="icon-circle"><i class="fa-solid fa-calendar-check"></i></div>
              <span class="menu-text">월간 업무일지</span>
          </li>
          <li class="menu-item" onclick="showPage('productlogs', this)" title="상품 수정 내역">
              <div class="icon-circle"><i class="fa-solid fa-boxes-packing"></i></div>
              <span class="menu-text">상품 수정 내역</span>
          </li>
          <li class="menu-item" onclick="showPage('notes', this)" title="업무 노트">
              <div class="icon-circle"><i class="fa-solid fa-note-sticky"></i></div>
              <span class="menu-text">업무 노트</span>
          </li>
          <li class="menu-item" onclick="showPage('ranking', this)" title="검색 순위">
              <div class="icon-circle"><i class="fa-solid fa-trophy"></i></div>
              <span class="menu-text">검색 순위</span>
          </li>
          <li class="menu-item" onclick="showPage('sales', this)" title="매출 분석">
              <div class="icon-circle"><i class="fa-solid fa-chart-line"></i></div>
              <span class="menu-text">매출 분석</span>
          </li>
        </ul>

<div class="shortcuts-area">
            <div class="shortcut-group">
                <div class="shortcut-title">쇼핑몰 관리자 바로가기</div>
                <a href="https://sell.smartstore.naver.com/#/home/about" target="_blank" title="스마트스토어">스마트스토어 <i class="fa-solid fa-arrow-up-right-from-square"></i></a>
                <a href="https://admin.pay.naver.com/home" target="_blank" title="네이버페이">네이버페이 <i class="fa-solid fa-arrow-up-right-from-square"></i></a>
                <a href="https://wing.coupang.com" target="_blank" title="쿠팡">쿠팡 <i class="fa-solid fa-arrow-up-right-from-square"></i></a>
                <a href="https://boonimall.kr/admin/login" target="_blank" title="홈페이지">홈페이지 <i class="fa-solid fa-arrow-up-right-from-square"></i></a>
                <a href="https://signin.esmplus.com/login" target="_blank" title="ESM">ESM <i class="fa-solid fa-arrow-up-right-from-square"></i></a>
                <a href="https://login.11st.co.kr" target="_blank" title="11번가">11번가 <i class="fa-solid fa-arrow-up-right-from-square"></i></a>
            </div>
            <div class="shortcut-group">
                <div class="shortcut-title">택배 시스템 바로가기</div>
                <a href="https://logis.ilogen.com" target="_blank" title="로젠택배">로젠택배 <i class="fa-solid fa-arrow-up-right-from-square"></i></a>
                <a href="https://partner.ds3211.co.kr" target="_blank" title="대신택배">대신택배 <i class="fa-solid fa-arrow-up-right-from-square"></i></a>
            </div>
            <div class="shortcut-group">
                <div class="shortcut-title">SNS 바로가기</div>
                <a href="https://blog.naver.com/taekwonv123" target="_blank" title="에너가드컴퍼니 공식 블로그">에너가드컴퍼니 공식 블로그 <i class="fa-solid fa-arrow-up-right-from-square"></i></a>
                <a href="https://www.youtube.com/@에너가드컴퍼니" target="_blank" title="에너가드컴퍼니 유튜브 채널">에너가드컴퍼니 유튜브 채널 <i class="fa-solid fa-arrow-up-right-from-square"></i></a>
                <a href="https://www.youtube.com/@한국단열" target="_blank" title="한국단열 유튜브 채널">한국단열 유튜브 채널 <i class="fa-solid fa-arrow-up-right-from-square"></i></a>
            </div>
            </div>
    
    <div class="sidebar-footer">
      <button class="toggle-sidebar-btn" onclick="toggleSidebar()" title="사이드바 열기/닫기">
          <i class="fa-solid fa-chevron-left"></i>
      </button>
    </div>
  </nav>

  <main class="main-content">
<header class="header">
      <div class="page-title" id="pageTitleText">지표 요약</div>
      <div class="header-controls">
        <span id="weather-info" title="포천시 가산면 실시간 날씨" style="display:flex; align-items:center; gap:6px;">
            <i class="fa-solid fa-cloud-sun"></i> 날씨 로딩중...
        </span>
        <div style="width:1px; height:16px; background:#e5e7eb;"></div>
        
        <span id="clock" style="font-feature-settings: 'tnum';">로딩중...</span>
        <div style="width:1px; height:16px; background:#e5e7eb;"></div>
        <span>관리자님</span>
        <button class="btn-logout" onclick="handleLogout()">로그아웃 <i class="fa-solid fa-arrow-right-from-bracket"></i></button>
      </div>
    </header>

    <div class="content-body">
      <div id="page-dashboard" class="page-section active">
        <div class="dash-card" style="margin-bottom: 24px;">
            <div class="dash-card-header" style="margin-bottom: 0; cursor: pointer;" onclick="toggleDashSales()">
                <h4 class="dash-card-title" title="클릭하여 펼치기/접기">
                    <div class="dash-card-icon" style="background: #4f46e5;"><i class="fa-solid fa-chart-line"></i></div>
                    판매 성과 (스마트스토어 + 쿠팡)
                    <span class="dash-card-subtitle">* 전월 동기간 대비</span>
                </h4>
                <div style="display: flex; align-items: center; gap: 15px;">
                    <div class="dash-refresh" onclick="event.stopPropagation(); refreshDashData('sales')" title="새로고침">
                        <span id="time-sales">로딩중...</span> <i class="fa-solid fa-rotate-right"></i>
                    </div>
                    <i class="fa-solid fa-chevron-down" id="dash-sales-toggle-icon" style="transition: transform 0.3s; color: #94a3b8;"></i>
                </div>
            </div>
            
            <div class="dash-stats-grid" id="dash-sales-content" style="display: none; margin-top: 20px; padding-top: 20px; border-top: 1px solid #f1f5f9;">
                <div class="dash-stat-item">
                    <div class="dash-stat-label"><div class="stat-icon-circle" style="background:#e0e7ff; color:#4f46e5;"><i class="fa-solid fa-users"></i></div> 방문수(유입)</div>
                    <div class="dash-stat-value" id="dash-traffic">-명</div>
                    <div class="dash-stat-diff" id="dash-traffic-diff">-</div>
                </div>
                <div class="dash-stat-item">
                    <div class="dash-stat-label"><div class="stat-icon-circle" style="background:#dcfce7; color:#10b981;"><i class="fa-solid fa-box-open"></i></div> 상품 결제수</div>
                    <div class="dash-stat-value" id="dash-pay">-건</div>
                    <div class="dash-stat-diff" id="dash-pay-diff">-</div>
                </div>
                <div class="dash-stat-item">
                    <div class="dash-stat-label"><div class="stat-icon-circle" style="background:#fef3c7; color:#f59e0b;"><i class="fa-solid fa-percent"></i></div> 구매 전환율</div>
                    <div class="dash-stat-value" id="dash-conv">-%</div>
                    <div class="dash-stat-diff" id="dash-conv-diff">-</div>
                </div>
                <div class="dash-stat-item">
                    <div class="dash-stat-label"><div class="stat-icon-circle" style="background:#f3e8ff; color:#8b5cf6;"><i class="fa-solid fa-won-sign"></i></div> 결제 금액</div>
                    <div class="dash-stat-value" id="dash-rev">-원</div>
                    <div class="dash-stat-diff" id="dash-rev-diff">-</div>
                </div>
            </div>
        </div>

        <div class="dash-card" style="margin-bottom: 24px;">
            <div class="dash-card-header">
                <h4 class="dash-card-title clickable" onclick="navigateFromDash('ranking')" title="검색 순위 페이지로 이동">
                    <div class="dash-card-icon" style="background: #f59e0b;"><i class="fa-solid fa-trophy"></i></div>
                    검색 순위 진단
                    <span class="dash-card-subtitle">* 최근 2주 비교</span>
                </h4>
                <div class="dash-refresh" onclick="refreshDashData('ranking')" title="새로고침">
                    <span id="time-ranking">로딩중...</span> <i class="fa-solid fa-rotate-right"></i>
                </div>
            </div>
            <div class="dash-rank-wrapper">
                <div class="dash-rank-box">
                    <div class="dash-rank-header">
                        <span style="color: #ef4444;"><i class="fa-solid fa-arrow-trend-up"></i> 순위 급상승 (10단계↑)</span>
                        <span class="dash-rank-badge" id="dash-rank-up-count" style="color:#ef4444; background:#fef2f2;">0건</span>
                    </div>
                    <div class="dash-rank-list-scroll" id="dash-rank-up-list">
                    </div>
                </div>
                <div class="dash-rank-box">
                    <div class="dash-rank-header">
                        <span style="color: #3b82f6;"><i class="fa-solid fa-arrow-trend-down"></i> 순위 급하락 (10단계↓)</span>
                        <span class="dash-rank-badge" id="dash-rank-down-count" style="color:#3b82f6; background:#eff6ff;">0건</span>
                    </div>
                    <div class="dash-rank-list-scroll" id="dash-rank-down-list">
                    </div>
                </div>
            </div>
        </div>

        <div class="dash-grid-2">
            <div class="dash-card">
                <div class="dash-card-header">
                    <h4 class="dash-card-title clickable" onclick="navigateFromDash('worklog')" title="업무일지로 이동">
                        <div class="dash-card-icon" style="background: #10b981;"><i class="fa-solid fa-calendar-check"></i></div> 
                        금주 주간 목표 <span class="dash-card-subtitle" id="dash-week-label"></span>
                    </h4>
                    <div class="dash-refresh" onclick="refreshDashData('tasks')" title="새로고침">
                        <span id="time-tasks">로딩중...</span> <i class="fa-solid fa-rotate-right"></i>
                    </div>
                </div>
                <ul class="dash-list" id="dash-task-list"></ul>
            </div>
            
            <div class="dash-card">
                <div class="dash-card-header">
                    <h4 class="dash-card-title clickable" onclick="navigateFromDash('productlogs')" title="상품수정 내역으로 이동">
                        <div class="dash-card-icon" style="background: #8b5cf6;"><i class="fa-solid fa-pen-to-square"></i></div> 
                        최근 상품 수정
                    </h4>
                    <div class="dash-refresh" onclick="refreshDashData('prodlogs')" title="새로고침">
                        <span id="time-prodlogs">로딩중...</span> <i class="fa-solid fa-rotate-right"></i>
                    </div>
                </div>
                <ul class="dash-list" id="dash-prodlog-list"></ul>
            </div>

            <div class="dash-card">
                <div class="dash-card-header">
                    <h4 class="dash-card-title clickable" onclick="navigateFromDash('notes', 'blog')" title="업무노트로 이동">
                        <div class="dash-card-icon" style="background: #10b981;"><i class="fa-solid fa-blog"></i></div> 
                        블로그 최신글
                    </h4>
                    <div class="dash-refresh" onclick="refreshDashData('blog')" title="새로고침">
                        <span id="time-blog">로딩중...</span> <i class="fa-solid fa-rotate-right"></i>
                    </div>
                </div>
                <ul class="dash-list" id="dash-blog-list"></ul>
            </div>

            <div class="dash-card">
                <div class="dash-card-header">
                    <h4 class="dash-card-title clickable" onclick="navigateFromDash('notes', 'youtube')" title="업무노트로 이동">
                        <div class="dash-card-icon" style="background: #ef4444;"><i class="fa-brands fa-youtube"></i></div> 
                        유튜브 최신영상
                    </h4>
                    <div class="dash-refresh" onclick="refreshDashData('youtube')" title="새로고침">
                        <span id="time-youtube">로딩중...</span> <i class="fa-solid fa-rotate-right"></i>
                    </div>
                </div>
                <ul class="dash-list" id="dash-yt-list"></ul>
            </div>
        </div>
        
        <div class="dash-footer">
            <span class="company-name">주식회사 에너가드컴퍼니</span><br>
            ADDRESS : 경기도 포천시 가산면 오성길 146<br>
            TEL : 031-511-0377 &nbsp;|&nbsp; FAX : 031-624-1646 &nbsp;|&nbsp; E-MAIL : mdf24t@naver.com<br>
            Copyright ⓒ 주식회사 에너가드컴퍼니. All Rights Reserved.
        </div>
      </div>

      <div id="page-timeline" class="page-section">
        <div class="card input-panel">
          <h3>
            <span>업무 기록</span>
            <div style="display:flex; align-items:center;">
              <div class="search-box" style="position: relative; margin-right: 12px;">
                <i class="fa-solid fa-magnifying-glass" style="position: absolute; left: 14px; top: 11px; color: #9ca3af;"></i>
                <input type="text" id="taskSearch" placeholder="기록 검색..." oninput="renderTimeLog()" style="padding: 10px 16px 10px 40px; border: 1px solid var(--border); border-radius: 20px; font-size: 14px; width: 220px; background: #f9fafb;">
              </div>
              <select id="yearFilter" onchange="renderTimeLog()" style="padding: 9px 12px; border: 1px solid var(--border); border-radius: 8px; font-weight: 600; margin-right: 12px; cursor: pointer; background: white;">
                <option value="2026">2026년</option>
              </select>
              <button class="btn-server" onclick="saveToServer()"><i class="fa-solid fa-cloud-arrow-up"></i> 전체 저장</button>
            </div>
          </h3>
          <div id="editModeMsg" style="display:none; color: var(--primary); font-weight:bold; margin-bottom:10px; font-size:14px;">
             📝 기존 항목 수정 중... <button onclick="cancelEditMode()" style="font-size:12px; padding:3px 8px; border:1px solid #ccc; background:white; cursor:pointer; margin-left:10px; border-radius:4px;">취소</button>
          </div>
          <div class="input-group-row">
            <div class="input-wrap small"><label>날짜</label><input type="date" id="tDate" class="form-input"></div>
            <div class="input-wrap small">
              <label>구분</label>
              <select id="tCategory" class="form-input">
                <option value="데일리">데일리</option><option value="광고">광고</option><option value="회의">회의</option>
                <option value="상품등록">상품등록</option><option value="상품수정">상품수정</option><option value="디자인">디자인</option>
                <option value="블로그">블로그</option><option value="유튜브">유튜브</option><option value="과장님업무">과장님업무</option>
                <option value="기타">기타</option><option value="휴무">휴무</option>
              </select>
            </div>
            <div class="input-wrap large"><label>업무 내용</label><input type="text" id="tTask" class="form-input" placeholder="내용을 입력하세요"></div>
            <div class="input-wrap"><label>시작</label><div class="time-split-box"><input type="text" id="tStartH" class="time-part" placeholder="" maxlength="2"><span style="font-weight: bold; color: #9ca3af;">:</span><input type="text" id="tStartM" class="time-part" placeholder="" maxlength="2"></div></div>
            <div class="input-wrap"><label>끝</label><div class="time-split-box"><input type="text" id="tEndH" class="time-part" placeholder="" maxlength="2"><span style="font-weight: bold; color: #9ca3af;">:</span><input type="text" id="tEndM" class="time-part" placeholder="" maxlength="2"></div></div>
            <button onclick="addTimeLog()" id="addLogBtn" class="btn-add"><i class="fa-solid fa-plus"></i> 등록</button>
          </div>
        </div>
        <div class="card" style="padding:0; overflow:hidden;">
          <table class="timeline-table">
            <thead><tr><th width="100">구분</th><th>업무</th><th width="80">시작</th><th width="80">끝</th><th width="100">소요시간</th><th width="110">관리</th></tr></thead>
            <tbody id="timelineList"></tbody>
          </table>
        </div>
      </div>

      <div id="page-worklog" class="page-section">
        <div class="card" style="padding: 0; overflow:hidden;">
            <div class="note-header">
              <div class="note-left">
                <h2>월간 업무 일지</h2>
                <div class="date-selector">
                    <input type="month" id="worklogPicker" onchange="handleMonthChange(this)" style="font-family:'Pretendard';">
                </div>
              </div>
              <div class="note-btns">
                  <button class="btn-server" onclick="collectAndSaveWorklog()" style="background:#111827;"><i class="fa-solid fa-cloud-arrow-up"></i> 저장하기</button>
              </div>
            </div>
            <div class="monthly-wrapper" id="monthlyContainer" style="padding: 25px;"></div>
        </div>
      </div>

      <div id="page-productlogs" class="page-section">
        <div class="card" style="padding:0; overflow:hidden;">
          <div style="padding: 20px; border-bottom: 1px solid var(--border);">
             <h2 style="margin:0;">전체 상품 수정 내역</h2>
          </div>
          <table class="timeline-table">
            <thead><tr><th width="150">날짜</th><th>수정 내역</th></tr></thead>
            <tbody id="productLogList"></tbody>
          </table>
        </div>
      </div>

      <div id="page-notes" class="page-section">
          <div class="note-container">
            <div class="note-header">
                <div class="note-left">
                    <h2>업무 노트</h2>
                    <div class="note-tabs">
                        <button class="tab-btn active" onclick="setNoteTab('general')">일반 노트</button>
                        <button class="tab-btn" onclick="setNoteTab('blog')">블로그 원고</button>
                        <button class="tab-btn" onclick="setNoteTab('youtube')">유튜브 원고</button>
                    </div>
                </div>
                <div class="note-controls">
                    <div class="status-indicator">
                        <i class="fa-solid fa-circle-check" style="font-size:10px; color:#10b981;"></i> 
                        <span id="noteSaveStatus">대기</span>
                    </div>
                    
                    <div class="date-selector-wrapper">
                        <input type="date" id="noteDate" onchange="handleNoteDateChange()">
                    </div>
                    
                    <button class="btn-icon-text btn-secondary" onclick="resetNoteToOriginal()">
                        <i class="fa-solid fa-rotate-left"></i> 취소
                    </button>
                    <button class="btn-icon-text btn-primary" onclick="saveNoteToServer()">
                        <i class="fa-solid fa-cloud-arrow-up"></i> 저장
                    </button>
                </div>
            </div>
            
            <div class="note-sub-header">
                <div class="search-wrapper">
                    <i class="fa-solid fa-magnifying-glass search-icon"></i>
                    <input type="text" id="noteSearchInput" class="search-input" placeholder="노트 제목 또는 내용 검색..." oninput="searchNotes()">
                    <div id="noteSearchResults"></div>
                </div>
            </div>

            <div id="draftListContainer">
                <div class="list-toolbar">
                    <button class="btn-icon-text btn-primary" onclick="createNewDraft()">
                        <i class="fa-solid fa-plus"></i> 새 원고 작성
                    </button>
                </div>
                <table class="styled-table">
                    <thead>
                        <tr>
                            <th width="120">작성일</th>
                            <th>제목</th>
                            <th width="100">상태</th>
                            <th width="150">최근 저장</th>
                        </tr>
                    </thead>
                    <tbody id="draftListBody">
                        </tbody>
                </table>
            </div>

            <div id="draftMetadataArea">
                <button class="btn-back" onclick="backToList()">
                    <i class="fa-solid fa-arrow-left"></i> 목록으로
                </button>
                <input type="text" id="draftTitle" placeholder="제목을 입력하세요...">
                <select id="draftStatus">
                    <option value="saving">💾 작성중</option>
                    <option value="uploaded">🚀 업로드됨</option>
                </select>
                <span id="draftLastSaved" style="font-size:12px; color:#94a3b8; min-width:120px; text-align:right;"></span>
            </div>

            <div id="editor-wrapper">
                <div id="editor"></div>
            </div>
        </div>
      </div>

      <div id="page-ranking" class="page-section">
        <div class="card" style="position: relative; padding: 0;">
            <div style="padding: 20px 30px 5px;">
                <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:15px;">
                    <h2 style="margin:0;">검색 순위 관리</h2>
                    <button id="editModeBtn" onclick="toggleEditMode()">✏️ 편집 모드</button>
                </div>
                <div class="tabs" style="margin-bottom:0;">
                    <button class="tab active" onclick="setTab('아이소핑크')">아이소핑크</button>
                    <button class="tab" onclick="setTab('스티로폼')">스티로폼</button>
                    <button class="tab" onclick="setTab('열반사단열재')">열반사단열재</button>
                    <button class="tab" onclick="setTab('단열벽지')">단열벽지</button>
                    <button class="tab" onclick="setTab('기타')">기타</button>
                </div>
            </div>
            
            <div class="ranking-scroll-wrapper">
                <table class="ranking-table">
                    <colgroup>
                        <col width="40px">  <col width="110px"> <col width="100px"> <col width="auto">  <col width="100px"> <col width="160px"> <col width="60px">  <col width="60px">  <col width="60px">  <col width="60px">  <col width="60px">  <col width="60px">  <col width="80px">  <col class="admin-col" width="70px" style="display:none;"> </colgroup>
                    <thead>
                        <tr>
                            <th></th> <th>상품번호</th> <th>이미지</th>
                            <th><input type="checkbox" id="masterCheck" onclick="toggleAllChecks(this.checked)" style="display:none; vertical-align:middle; margin-right:5px; cursor:pointer;" title="전체 선택/해제"> 상품명</th> 
                            <th>가격</th> <th>키워드</th> <th>변동</th>
                            <th>1주차</th> <th>2주차</th> <th>3주차</th> <th>4주차</th> <th>5주차</th> 
                            <th>비고</th> <th class="admin-col" style="display:none;">관리</th>
                        </tr>
                    </thead>
                    <tbody id="list"></tbody>
                </table>
            </div>

            <div style="padding: 15px 30px 25px;">
                <div class="btn-area" id="adminPanel" style="display:none;">
                    <button id="addProdBtn" class="big-btn" onclick="addEmptyRow()">+ 신규 상품(메인) 추가</button>
                    <button id="saveBtn" class="big-btn" onclick="saveData()">💾 저장하고 서버에 반영하기</button>
                    <button id="resetBtn" class="big-btn" onclick="resetData()">🔄 변경취소 (다시 불러오기)</button>
                    <button id="downloadBtn" class="big-btn" onclick="downloadCSV()">📥 엑셀로 백업하기</button>
                </div>
            </div>
        </div>
      </div>

      <div id="page-sales" class="page-section">
        <div class="card" style="padding-bottom: 0; background: transparent; box-shadow: none; border: none;">
            <div style="display:flex; justify-content:space-between; align-items:flex-end; margin-bottom:15px;">
                <h2 style="margin:0;">매출 데이터 분석</h2>
                <div class="tabs" style="margin-bottom:0; gap:5px;">
                    <button class="tab active" onclick="setSalesTab('스마트스토어')" style="border-radius:6px; min-width:120px; font-size:14px;">스마트스토어</button>
                    <button class="tab" onclick="setSalesTab('쿠팡')" style="border-radius:6px; min-width:120px; font-size:14px;">쿠팡</button>
                </div>
            </div>
            
            <div class="sales-dashboard-top">
                <div class="chart-box">
                    <div class="chart-header">
                        💰 결제금액 및 광고비 추이
                    </div>
                    <div class="chart-container half-height"><canvas id="salesChartFinancial"></canvas></div>
                </div>
                <div class="chart-box">
                    <div class="chart-header">
                        📈 결제수 및 전환율 추이
                        <div class="mini-controls">
                            <label><input type="checkbox" id="chkPayCount" onchange="renderSales()" checked> 결제수</label>
                            <label><input type="checkbox" id="chkConv" onchange="renderSales()" checked> 전환율</label>
                        </div>
                    </div>
                    <div class="chart-container half-height"><canvas id="salesChartTraffic"></canvas></div>
                </div>
            </div>
            
            <div class="card" style="padding:0; overflow:hidden;">
                <div style="padding: 15px 20px; display:flex; justify-content:space-between; align-items:center; border-bottom: 1px solid var(--border);">
                    <h3 style="margin:0; font-size:16px;">월별 상세 내역</h3>
                    <div class="edit-controls" style="text-align:right;">
                        <button id="editSalesBtn" onclick="toggleSalesEditMode()">✏️ 편집</button>
                        <button id="addSalesRowBtn" onclick="addSalesRow()">+ 다음 달 추가</button>
                        <button id="resetSalesBtn" onclick="resetSalesData()">🔄 초기화</button>
                        <button id="saveSalesBtn" onclick="saveSalesData()">💾 저장</button>
                        <button id="downloadSalesBtn" onclick="downloadSalesCSV()" style="background:#34495e;">📥 엑셀</button>
                    </div>
                </div>
<div class="table-scroll-wrapper" style="width: 100%; overflow-x: auto; padding-bottom: 5px;">
                    <table class="sales-table-style">
<colgroup>
                            <col width="90px">  
                            <col width="220px"> <col width="170px"> <col width="130px"> <col width="100px"> <col width="110px"> <col width="90px">  <col width="100px"> <col class="col-smart" width="110px">   
                            <col class="col-smart" width="110px">   
                            <col class="col-coupang" width="110px"> 
                            <col class="col-delete" width="60px">   
                        </colgroup>
                        <thead> <tr>
                                <th>년월</th> 
                                <th>결제금액(원)</th>
                                <th>증감률</th> 
                                <th>광고비(원)</th> 
                                <th>ROAS</th> 
                                <th>전체유입수</th> 
                                <th>결제수</th> 
                                <th>전환율</th> 
                                <th class="col-smart">모바일비율</th> 
                                <th class="col-smart">환불금액비율</th>
                                <th class="col-coupang" style="display:none;">위너비율</th> 
                                <th class="col-delete" style="display:none;">삭제</th>
                            </tr>
                        </thead>
                        <tbody id="salesList" class="sales-table"></tbody>
                    </table>
                </div>
            </div>
        </div>
      </div>
    </div> </main>
<aside class="right-quickbar">
    <ul class="quick-menu-list">
        <li class="quick-item" onclick="toggleQuickMemo()">
            <div class="quick-icon" style="background:#e0e7ff; color:#4f46e5;">
                <i class="fa-regular fa-note-sticky"></i>
                <span class="badge-n">N</span>
            </div>
            <span class="quick-text">퀵 메모</span>
        </li>
        <li class="quick-item" onclick="toggleAIChat()">
            <div class="quick-icon" style="background:#dcfce7; color:#10b981;">
                <i class="fa-solid fa-robot"></i>
                <span class="badge-n">N</span>
            </div>
            <span class="quick-text">AI 챗</span>
        </li>
        <li class="quick-item" onclick="toggleCalcPanel()">
            <div class="quick-icon" style="background:#fef3c7; color:#d97706;">
                <i class="fa-solid fa-calculator"></i>
            </div>
            <span class="quick-text">계산기</span>
        </li>
        <li class="quick-item" onclick="toggleWidgetPanel()">
            <div class="quick-icon" style="background:#fee2e2; color:#ef4444;">
                <i class="fa-solid fa-basketball"></i>
            </div>
            <span class="quick-text">위젯</span>
        </li>
    </ul>
  </aside>

  <div id="quickMemoPanel" class="quick-panel">
    <div class="quick-panel-header">
        <h3><i class="fa-regular fa-note-sticky"></i> 퀵 메모</h3>
        <button class="close-panel-btn" onclick="toggleQuickMemo()"><i class="fa-solid fa-xmark"></i></button>
    </div>
    <div class="quick-panel-body">
        <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:10px;">
            <div class="quick-memo-date" id="quickMemoDate"></div>
            <span style="font-size:11px; color:#94a3b8;">업무노트 자동 연동</span>
        </div>
        <div id="quick-editor-wrapper" style="flex:1; display:flex; flex-direction:column; margin-bottom:15px; border:1px solid #e2e8f0; border-radius:8px; overflow:hidden;">
            <div id="quickEditor"></div>
        </div>
        <button class="quick-save-btn" onclick="saveQuickMemo()">
            <i class="fa-solid fa-cloud-arrow-up"></i> 저장 및 동기화
        </button>
        <div id="quickMemoStatus" style="font-size:12px; font-weight:bold; color:#10b981; text-align:center; margin-top:10px; height:15px;"></div>
    </div>
  </div>

  <div id="aiChatPanel" class="quick-panel">
      <div class="quick-panel-header">
          <h3><i class="fa-solid fa-robot"></i> AI 챗</h3>
          <button class="close-panel-btn" onclick="toggleAIChat()"><i class="fa-solid fa-xmark"></i></button>
      </div>
      <div class="quick-panel-body" style="padding:0; background:#f8fafc;">
          <div class="chat-messages-container" id="chatMessages">
              <div class="chat-message ai">
                  <div class="chat-avatar"><i class="fa-solid fa-robot"></i></div>
                  <div class="chat-bubble">안녕하세요! 에너가드컴퍼니 AI 업무 비서입니다. 단열재 관련 원고 작성이나 업무 관련 질문을 편하게 남겨주세요.</div>
              </div>
          </div>
          <div class="chat-input-wrapper">
              <textarea id="aiChatInput" placeholder="메시지를 입력하세요... (Shift+Enter 줄바꿈)"></textarea>
              <button class="chat-send-btn" onclick="sendChatMessage()"><i class="fa-solid fa-paper-plane"></i></button>
          </div>
      </div>
  </div>

  <div id="calcPanel" class="quick-panel">
    <div class="quick-panel-header">
        <h3><i class="fa-solid fa-calculator"></i> 계산기</h3>
        <button class="close-panel-btn" onclick="toggleCalcPanel()"><i class="fa-solid fa-xmark"></i></button>
    </div>
    <div class="quick-panel-body" style="padding: 0; background: #f8fafc;">
        <div style="padding: 15px; border-bottom: 1px solid #e5e7eb;">
            <select id="calcSelector" onchange="changeCalculator(this.value)" style="width: 100%; padding: 10px; border: 1px solid #cbd5e1; border-radius: 6px; font-family: 'Pretendard', sans-serif; font-size: 14px; outline: none; font-weight: 600; cursor: pointer;">
                <option value="https://gi.esmplus.com/0804bear/window_insulation/new/window_estimate_new_v2.html">창문형 단열재 계산기</option>
                <option value="https://gi.esmplus.com/0804bear/calculate/insulation-board-calc-hkdy.html">판상형 단열재 계산기</option>
                <option value="https://gi.esmplus.com/0804bear/calculate/insulation-board-calc-roll-hkdy.html">열반사 단열재 계산기</option>
                <option value="https://gi.esmplus.com/0804bear/calculate/insulation-board-calc-wall.html">단열벽지 계산기</option>
                <option value="https://gi.esmplus.com/0804bear/calculate/insulation-board-camp.html">캠핑단열재 계산기</option>
                <option value="https://gi.esmplus.com/0804bear/calculate/insulation-board-t.html">단열재 두께 계산기</option>
                <option value="https://gi.esmplus.com/0804bear/calculate/insulation-board-bundle.html">단열재 단수 계산기</option>
            </select>
        </div>
        <div style="flex: 1; position: relative;">
            <iframe id="calcFrame" src="" style="width: 100%; height: 100%; border: none; position: absolute; top: 0; left: 0;"></iframe>
        </div>
    </div>
  </div>

  <div id="widgetPanel" class="quick-panel">
    <div class="quick-panel-header">
        <h3><i class="fa-solid fa-trophy" style="color: #e11d48;"></i> 위젯</h3>
        <button class="close-panel-btn" onclick="toggleWidgetPanel()"><i class="fa-solid fa-xmark"></i></button>
    </div>
    <div class="quick-panel-body" style="padding: 0; background-color: #f8fafc;">
        <div class="sp-tabs">
            <button class="sp-tab-btn active" onclick="setWidgetTab('nba',this)">NBA</button>
            <button class="sp-tab-btn" onclick="setWidgetTab('epl',this)">EPL</button>
            <button class="sp-tab-btn" onclick="setWidgetTab('ucl',this)">UCL</button>
            <button class="sp-tab-btn" onclick="setWidgetTab('mlb',this)">MLB</button>
        </div>
        <div class="sp-meta-bar">
            <span class="sp-update-time" id="sp-updateTime">업데이트 대기</span>
            <button class="sp-refresh-btn" onclick="reloadWidget()">
                <i class="fa-solid fa-rotate-right" id="sp-refreshIcon"></i> 새로고침
            </button>
        </div>
        <div class="sp-content" id="sp-content">
            <div class="sp-state-box sp-loading">
                <i class="fa-solid fa-spinner fa-spin"></i>
                <span>불러오는 중...</span>
            </div>
        </div>
    </div>
  </div>
  <div id="memoModal" class="modal-overlay">
    <div class="modal-box">
      <h4>비고 내용 입력</h4>
      <input type="text" id="modalInput" placeholder="내용을 입력하세요..." onkeypress="handleEnter(event)">
      <div class="modal-btns">
        <button class="btn-cancel" onclick="closeModal()">취소</button>
        <button class="btn-confirm" onclick="saveMemoFromModal()">저장</button>
      </div>
    </div>
  </div>
  <div id="rankingMemoModal" class="modal-overlay">
    <div class="modal-box" style="width: 380px;">
      <h4>검색 순위 비고 관리</h4>
      <div id="memoListArea" style="max-height: 200px; overflow-y: auto; margin-bottom: 15px; border: 1px solid #e2e8f0; border-radius: 6px; padding: 10px; background: #f8fafc;"></div>
      <div style="display: flex; gap: 8px; margin-bottom: 15px;">
          <input type="text" id="newMemoInput" placeholder="새로운 메모 입력..." style="flex: 1; padding: 8px; border: 1px solid #d1d5db; border-radius: 6px;" onkeypress="if(event.key==='Enter') addNewMemo()">
          <button onclick="addNewMemo()" style="background: #4f46e5; color: white; border: none; border-radius: 6px; padding: 0 15px; cursor: pointer; font-weight: bold;">추가</button>
      </div>
      <div class="modal-btns">
        <button class="btn-cancel" onclick="closeRankingMemoModal()">닫기</button>
      </div>
    </div>
  </div>
<script src="js/common.js"></script>
<script src="js/tasks.js"></script>
<script src="js/analytics.js"></script>
<script src="js/dashboard.js"></script>

</body>
</html>